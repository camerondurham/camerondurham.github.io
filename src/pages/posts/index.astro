---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Search from '../../components/Search.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts')).sort((a, b) => 
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<BaseLayout title="Posts | Cameron Durham">
  <h1>Posts</h1>
  <Search />
  <div class="posts-list">
    {posts.map(post => (
      <article class="post-item">
        <h2><a href={`/posts/${post.slug}`}>{post.data.title}</a></h2>
        <time datetime={post.data.date}>{post.data.date}</time>
        {post.data.tags.length > 0 && (
          <div class="tags">
            {post.data.tags.map(tag => <a href={`/tags/${tag}`} class="tag">{tag}</a>)}
          </div>
        )}
        {post.data.summary && <p>{post.data.summary}</p>}
      </article>
    ))}
  </div>
</BaseLayout>

<style>
.posts-list { display: flex; flex-direction: column; gap: 2rem; padding-top: 1rem; }
.post-item { border-bottom: 1px solid var(--border-color); padding-bottom: 2rem; }
.post-item:last-child { border-bottom: none; }
.post-item h2 { margin-bottom: 0.5rem; }
.post-item h2::before { content: none; }
.post-item time { display: block; margin-bottom: 0.5rem; }
.tags { display: flex; gap: 0.5rem; margin-bottom: 0.5rem; }
.tag { background: var(--bg-1); padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.85rem; color: var(--text-1); }
.tag:hover { background: var(--primary-color); color: var(--hover-color); }
</style>
